/*! X-Framework 02-08-2013 */
(function(t,e){var n=null,a=$.fn.hide;$.fn.hide=function(){var t=a.apply(this,arguments);return $(this).trigger("hide"),t};var i=$.fn.show;$.fn.show=function(){var t=i.apply(this,arguments);return $(this).trigger("show"),t};var o=$.fn.html;$.fn.html=function(){var t=o.apply(this,arguments);return $(this).trigger("show"),$(this).trigger("html"),t};var s=$.fn.append;$.fn.append=function(){var t=s.apply(this,arguments);return $(this).trigger("append"),t};var r=$.fn.prepend;$.fn.prepend=function(){var t=r.apply(this,arguments);return $(this).trigger("prepend"),t},$.fn.animationEnd=function(t){var e="webkitAnimationEnd oAnimationEnd msAnimationEnd animationend";return $(this).one(e,t),this},_.isFunction($.fn.detach)||($.fn.detach=function(t){return this.remove(t,!0)}),_.isFunction($.fn.wrapInner)||($.fn.wrapInner=function(t){return _.isFunction(t)?this.each(function(e){$(this).wrapInner(t.call(this,e))}):this.each(function(){var e=$(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})});var l=$.fn.detach;$.fn.detach=function(){var t=$(this).parent(),e=l.apply(this,arguments);return t.trigger("detach"),e},XF=t.XF=t.XF||{},XF.Events=e.Events,_.extend(XF,XF.Events),XF.navigate=function(t){XF.Router.navigate(t,{trigger:!0})},XF.on("navigate",XF.navigate),XF.start=function(t){t=t||{},_.extend(XF.Settings.options,t.settings),XF.Cache.init(),t.device=t.device||{},XF.Device.init(t.device.types),t.router=t.router||{},c(t.router),d(),u(),XF.Router.start(),n=t.root,n||(n=$("body")),t.animations=t.animations||{},t.animations.default=t.animations.default||"",XF.Pages.start(t.animations),p(n)},XF.Utils={},XF.Utils.AddressBar={},_.extend(XF.Utils.AddressBar,{BODY_SCROLL_TOP:!1,getScrollTop:function(){var e=t,n=document;return e.pageYOffset||"CSS1Compat"===n.compatMode&&n.documentElement.scrollTop||n.body.scrollTop||0},hide:function(){console.log("XF :: Utils :: AddressBar :: hide");var e=t;if(location.hash||XF.Utils.AddressBar.BODY_SCROLL_TOP===!1||e.scrollTo(0,1===XF.Utils.AddressBar.BODY_SCROLL_TOP?0:1),XF.Device.isMobile){var n=document.documentElement.style;return n.height="200%",n.overflow="visible",t.scrollTo(0,1),n.height=t.innerHeight+"px",!0}},hideOnLoad:function(){console.log("XF :: Utils :: AddressBar :: hideOnLoad");var e=t,n=e.document;!location.hash&&e.addEventListener&&(t.scrollTo(0,1),XF.Utils.AddressBar.BODY_SCROLL_TOP=1,bodycheck=setInterval(function(){n.body&&(clearInterval(bodycheck),XF.Utils.AddressBar.BODY_SCROLL_TOP=XF.Utils.AddressBar.getScrollTop())},15),e.addEventListener("load",function(){setTimeout(function(){20>XF.Utils.AddressBar.getScrollTop()},0)}))}});var c=function(t){if(XF.Router)throw"XF.createRouter can be called only ONCE!";XF.Router=new(XF.RouterClass.extend(t))},d=function(){$("body").on("tap click","[data-href]",function(){var t=$(this).data("animation")||null;t&&XF.trigger("pages:animation:next",t),XF.Router.navigate($(this).data("href"),{trigger:!0})})},p=function(t){$(t).find("[data-component][data-cache=true],[data-component]:visible").each(function(t,e){var n=$(e).attr("data-id"),a=$(e).attr("data-component");h(n,a,!0)})},h=function(t,e){v(e,function(n){if(!m[t]){var a=new n(e,t);console.log("XF :: loadChildComponent - created : "+t),m[t]=a,a.construct()}})},u=function(){$("[data-component]").on("show",function(t){if(t.currentTarget==t.target){var e=$(this).attr("data-id");if(!m[e]){var n=$(this).attr("data-component");h(e,n)}XF.UIElements.enhanceView($(this))}})},f=function(t,e){var n=document.createElement("script");n.readyState?n.onreadystatechange=function(){("loaded"==n.readyState||"complete"==n.readyState)&&(n.onreadystatechange=null,e&&e())}:n.onload=function(){e&&e()},n.src=t,document.getElementsByTagName("head")[0].appendChild(n)},m={},g={},v=function(t,e){var n=g[t];return n||(n=XF.registerComponent(t,XF.Settings.property("componentUrlFormatter")(t))),n.loaded?(e(n.compDef),void 0):(n.callbacks.push(e),n.loading||(n.loading=!0,f(n.compSrc)),void 0)};XF.getComponentByID=function(t){return m[t]},XF.registerComponent=function(t,e){var n=g[t];return n?n:(g[t]=new x(e),g[t])},XF.defineComponent=function(t,e){var n=g[t];for(n||(n=g[t]=new x(null)),g[t].loading=!1,g[t].loaded=!0,g[t].compDef=e;n.callbacks.length;)n.callbacks.pop()(n.compDef)},XF.requireComponent=function(t,e){v(t,e)};var b={};XF.setOptionsByID=function(t,e){b[t]=e};var F=function(t){return b[t]||{}};XF.history=e.history,XF.Settings={options:{applicationVersion:"1.0.0",noCache:!1,componentUrlPrefix:"",componentUrlPostfix:".js",componentUrlFormatter:function(t){return XF.Settings.property("componentUrlPrefix")+t+XF.Settings.property("componentUrlPostfix")},templateUrlPrefix:"",templateUrlPostfix:".tmpl",templateUrlFormatter:function(t,e){return XF.Settings.property("templateUrlPrefix")+e+t+XF.Settings.property("templateUrlPostfix")},dataUrlPrefix:"",dataUrlPostfix:".json",dataUrlFormatter:function(t){return XF.Settings.property("dataUrlPrefix")+t+XF.Settings.property("dataUrlPostfix")},touchableSwipeLength:100,touchableDoubleTapInterval:700,touchableLongTapInterval:500,animations:{}},getProperty:function(t){return this.options[t]},setProperty:function(t,e){this.options[t]=e},property:function(t,e){return void 0===e?this.getProperty(t):(this.setProperty(t,e),void 0)}},XF.Cache={storage:null,available:!1,init:function(){this.storage=t.localStorage;try{this.storage.setItem("check","check"),this.storage.removeItem("check"),this.available=!0}catch(e){this.available=!1}var n=this.get("applicationVersion");XF.Settings.property("noCache")?(console.log("XF.Cache :: init - cache is disable for the whole app manually - clearing storage"),this.clear(),this.set("applicationVersion",XF.Settings.property("applicationVersion"))):n&&n==XF.Settings.property("applicationVersion")?console.log("XF.Cache :: init - same version is cached - useing it as much as possible"):(console.log("XF.Cache :: init - wrong or no version cached - clearing storage"),this.clear(),this.set("applicationVersion",XF.Settings.property("applicationVersion")))},get:function(t){var e;if(this.available)try{e=this.storage.getItem(t),console.log('XF.Cache :: get - "'+t+'" = "'+e+'"')}catch(n){e=null}else e=null;return e},set:function(t,e){var n;if(this.available)try{this.storage.setItem(t,e),n=!0,console.log('XF.Cache :: set - "'+t+'" = "'+e+'"')}catch(a){n=!1}else n=!1;return n},clear:function(){var t;if(this.available)try{this.storage.clear(),t=!0,console.log("XF.Cache :: clear")}catch(e){t=!1}else t=!1;return t}},XF.Router=null,XF.RouterClass=e.Router,_.extend(XF.RouterClass.prototype,{start:function(){this.bindAnyRoute(),XF.history.start()},bindAnyRoute:function(){this.on("route",function(){console.log("XF.Router :: route: ",this.getPageNameFromFragment(XF.history.fragment)),XF.Pages&&XF.Pages.show(this.getPageNameFromFragment(XF.history.fragment))})},getPageNameFromFragment:function(t){var e=t.replace(/^\/+/,"").replace(/\/+$/,"").split("/");return e[0]}}),XF.Component=function(t,e){this.name=t||"default_name",this.id=e||"default_id",this.rendered=!1;var n=function(){this.unbind("refresh",n),this.rendered=!0};this.bind("refresh",n);var a=this.options,i=F(this.id);this.options=_.defaults(i,a)},XF.Component.template=null,XF.Component.templateURL=!1,XF.Component.templateLoaded=!1,XF.Component.templateLoading=!1,XF.Component.compiledTemplate=null,_.extend(XF.Component.prototype,XF.Events),_.extend(XF.Component.prototype,{options:{},modelClass:XF.Model,model:null,viewClass:XF.View,view:null,construct:function(){var t=function(){this.view.unbind("construct",t),this.afterConstructView(),this.init(),this.trigger("init"),this.trigger("construct"),XF.trigger(this.id+":constructed")},e=function(){this.model.unbind("construct",e),this.afterConstructModel(),this.beforeConstructView(),this.constructView(),this.view.bind("construct",t,this),this.view.construct()};this.beforeConstructModel(),this.constructModel(),this.model.bind("construct",e,this),this.model.construct(),this.childComponent=[]},selector:function(){return"[data-id="+this.id+"]"},beforeConstructView:function(){},constructView:function(){this.view&&this.view instanceof XF.View||(this.viewClass?(this.view=new this.viewClass,this.view instanceof XF.View||(this.view=new XF.View)):this.view=new XF.View),this.view.component=this},afterConstructView:function(){},beforeConstructModel:function(){},constructModel:function(){this.model&&this.model instanceof XF.Model||(this.modelClass?(this.model=new this.modelClass,this.model instanceof XF.Model||(this.model=new XF.Model)):this.model=new XF.Model),this.model.component=this},afterConstructModel:function(){},init:function(){this.refresh()},refresh:function(){var t=function(){this.model.unbind("refresh",t),this.view.refresh(),this.trigger("refresh")};this.model.bind("refresh",t,this),this.model.refresh()},ready:function(t){if(this.rendered)t();else{var e=function(){this.unbind("refresh",e),t()};this.bind("refresh",e,this)}}}),XF.Component.extend=e.Model.extend;var x=function(t){this.compSrc=t,this.compDef=null,this.loading=!1,this.loaded=!1,this.callbacks=[]};return XF.Model=e.Model.extend({component:null,rawData:null,dataURL:null,dataRequestSettings:null,isEmptyData:!1,isStaticData:!1,isStringData:!1,autoUpdateInterval:0,updateInBackground:!1,updateOnShow:!1,defaults:null,construct:function(){if(this.initialize(),this.trigger("init"),this.autoUpdateInterval>0){var t=_.bind(function(){$(this.component.selector()).is(":visible")?this.refresh():this.updateInBackground&&this.refresh()},this);setInterval(t,this.autoUpdateInterval)}this.updateOnShow&&$(this.component.selector()).bind("show",_.bind(this.refresh,this)),this.trigger("construct")},refresh:function(){var t=function(){this.unbind("dataLoaded",t),this.component.view.renderVersion,this.afterLoadData(),this.trigger("refresh")};this.bind("dataLoaded",t),this.beforeLoadData(),this.loadData()},getDataURL:function(){if(!this.dataURL){if(!this.component)throw'XF.Model "component" linkage lost';this.dataURL=_.bind(XF.Settings.property("dataUrlFormatter"),this)(this.component.name)}return this.dataURL},getDataRequestSettings:function(){return this.dataRequestSettings||{}},beforeLoadData:function(){},loadData:function(){if(this.isEmptyData||this.rawData&&this.isStaticData&&!(this.autoUpdate>0))this.trigger("dataLoaded");else{var t=this,e=this.getDataURL();$.ajax(_.extend(this.getDataRequestSettings(),{url:e,complete:function(e,n){if(!t.component)throw'XF.Model "component" linkage lost';t.rawData="success"==n?t.isStringData?e.responseText:JSON.parse(e.responseText):t.isStringData?{}:"",t.trigger("dataLoaded")}}))}},afterLoadData:function(){}}),XF.View=e.View.extend({component:null,templateURL:null,ignoreModelUpdate:!1,updateOnShow:!1,useCache:!1,construct:function(){var t=function(){return this.loadTemplateFailed?(this.unbind("templateLoaded",t),this.afterLoadTemplateFailed(),void 0):this.component.constructor.templateLoaded?(this.unbind("templateLoaded",t),this.afterLoadTemplate(),this.initialize(),this.trigger("init"),this.ignoreModelUpdate||this.component.model.bind("changed",this.refresh,this),this.updateOnShow&&$(this.component.selector()).bind("show",_.bind(this.refresh,this)),this.trigger("construct"),void 0):(this.loadTemplate(),void 0)};this.bind("templateLoaded",t),this.beforeLoadTemplate(),this.loadTemplate()},lastDeviceType:null,getTemplateURL:function(){if(this.lastDeviceType&&(this.templateURL=null),!this.templateURL){if(!this.component)throw'XF.View "component" linkage lost';if(this.lastDeviceType=XF.Device.getNextType(this.lastDeviceType),!this.lastDeviceType)return null;var t="";this.lastDeviceType&&this.lastDeviceType.templatePath&&(t=this.lastDeviceType.templatePath),this.templateURL=XF.Settings.property("templateUrlFormatter")(this.component.name,t)}return this.templateURL},getMarkup:function(){return this.component.constructor.compiledTemplate||(this.component.constructor.compiledTemplate=_.template(this.component.constructor.template)),this.component.constructor.compiledTemplate(this.component.model)},beforeLoadTemplate:function(){},loadTemplateFailed:!1,loadTemplate:function(){var t=this.getTemplateURL();if(null==t)return this.loadTemplateFailed=!0,this.trigger("templateLoaded"),void 0;if(this.useCache){var e=XF.Cache.get(t);if(e)return this.component.constructor.template=e,this.component.constructor.templateLoaded=!0,this.trigger("templateLoaded"),void 0}if(this.component.constructor.templateLoaded||this.component.constructor.templateLoading)if(this.component.constructor.templateLoading){var n=this;t=this.component.constructor.templateURL;var a=function(e){e.url==t&&(XF.unbind("templateLoaded",a),n.trigger("templateLoaded"))};XF.bind("templateLoaded",a)}else this.trigger("templateLoaded");else{this.component.constructor.templateURL=t,this.component.constructor.templateLoading=!0;var n=this;$.ajax({url:t,complete:function(e,a){if(!n.component)throw'XF.View "component" linkage lost';if("success"==a){var i=e.responseText;n.useCache&&XF.Cache.set(t,i),n.component.constructor.template=e.responseText,n.component.constructor.templateLoading=!1,n.component.constructor.templateLoaded=!0,n.trigger("templateLoaded"),XF.trigger("templateLoaded",{url:t,template:i})}else n.component.constructor.template=null,n.component.constructor.templateLoading=!1,n.component.constructor.templateLoaded=!1,n.trigger("templateLoaded"),XF.trigger("templateLoaded",{url:t,template:null})}})}},afterLoadTemplate:function(){},afterLoadTemplateFailed:function(){console.log('XF.View :: afterLoadTemplateFailed - could not load template for "'+this.component.id+'"'),console.log("XF.View :: afterLoadTemplateFailed - @dev: verify XF.Device.types settings & XF.View :: getTemplate URL overrides")},refresh:function(){this.preRender(),this.render(),this.postRender(),this.trigger("refresh")},preRender:function(){},renderVersion:0,render:function(){this.renderVersion++;var t=$("[data-id="+this.component.id+"]");t.html(this.getMarkup()),p(t)},postRender:function(){}}),XF.Pages={pageClass:"xf-page",activePageClass:"xf-page-active",animations:{"default":"slideleft",next:null,types:{none:{fallback:function(){}},fade:{fallback:function(){}},slideleft:{fallback:function(){}},slideright:{fallback:function(){}}}},activePage:null,activePageName:"",start:function(t){XF.on("pages:show",_.bind(XF.Pages.show,XF.Pages)),XF.on("pages:animation:next",_.bind(XF.Pages.setNextAnimationType,XF.Pages)),XF.on("pages:animation:default",_.bind(XF.Pages.setDefaultAnimationType,XF.Pages)),_.has(t,"types")&&_.extend(this.animations.types,t.types),_.has(t,"default")&&this.setDefaultAnimationType(t.default);var e=n.find(" ."+this.pageClass);if(e.length){var a=e.filter("."+this.activePageClass);a.length?(this.activePage=a,this.activePageName=a.attr("id")):this.show(e.first())}},setDefaultAnimationType:function(t){XF.Pages.animations.types[t]&&(XF.Pages.animations.default=t)},setNextAnimationType:function(t){XF.Pages.animations.types[t]&&(XF.Pages.animations.next=t)},show:function(e,n){if(""!==e&&e!==this.activePageName){var a=e instanceof $?e:$("."+XF.Pages.pageClass+"#"+e);if((!this.activePage||a.attr("id")!=this.activePage.attr("id"))&&a.length){console.log("XF.Pages :: showing page",a.attr("id"));var i=XF.Device.getViewport();XF.Device.getScreenHeight(),this.animations.next?(n=this.animations.types[this.animations.next]?this.animations.next:this.animations.default,this.animations.next=null):n=this.animations.types[n]?n:this.animations.default,console.log(n);var o=this.activePage,s=a;if(this.activePage=s,this.activePageName=a.attr("id"),!XF.Device.hasAnimation&&_.isFunction(this.animations.types[n].fallback))return s.addClass(this.activePageClass),this.animations.types[n].fallback(o,s),void 0;o?(i.addClass("xf-viewport-transitioning"),o.addClass("out "+n),s.addClass("in "+n+" "+this.activePageClass),o.animationEnd(function(){o.height("").removeClass(n+" out in"),o.removeClass(XF.Pages.activePageClass)}),s.animationEnd(function(){s.height("").removeClass(n+" out in"),i.removeClass("xf-viewport-transitioning")})):this.activePage.addClass(this.activePageClass),t.scrollTo(0,1),p(this.activePage[0])}}}},XF.Device={size:{width:0,height:0},isMobile:/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||t.opera).toLowerCase()),types:[{name:"desktop",range:{max:null,min:1025},templatePath:"desktop/",fallBackTo:"tablet"},{name:"tablet",range:{max:1024,min:480},templatePath:"tablet/",fallBackTo:"mobile"},{name:"mobile",range:{max:480,min:null},templatePath:"mobile/",fallBackTo:"default"}],defaultType:{name:"default",range:{min:null,max:null},templatePath:"",fallBackTo:null},type:this.defaultType,isTouchable:!1,init:function(t){this.types=t||this.types,this.detectType(),this.detectTouchable()},detectType:function(){this.size.width=$(t).width(),this.size.height=$(t).height(),console.log('XF.DeviceClass :: detectType - width = "'+this.size.width+'"'),console.log('XF.DeviceClass :: detectType - height = "'+this.size.height+'"');var e=Math.max(this.size.width,this.size.height);console.log('XF.DeviceClass :: detectType - maxSide = "'+e+'"');var n=null;_.each(this.types,function(t){try{(!t.range.min||t.range.min&&e>t.range.min)&&(!t.range.max||t.range.max&&t.range.max>e)&&(n=t)}catch(a){console.log("XF.DeviceClass :: detectType - bad type detected - skipping"),console.log("XF.DeviceClass :: detectType - @dev: plz verify types list")}}),n?this.type=n:(this.type=this.defaultType,console.log("XF.DeviceClass :: detectType - could not choose any of device type"),console.log("XF.DeviceClass :: detectType - drop back to this.defaultType"),console.log("XF.DeviceClass :: detectType - @dev: plz verify types list")),console.log('XF.DeviceClass :: detectType - selected type "'+this.type.name+'"')},getNextType:function(t){var e=this.type;return t&&(e=t.fallBackTo?this.getTypeByName(t.fallBackTo):this.defaultType),e&&e.templatePath||(e=this.defaultType),e==t?(console.log("XF.DeviceClass :: getNextType - infinit cycle of drop down logic detected"),console.log("XF.DeviceClass :: getNextType - stop trying, no template is available"),null):e},getTypeByName:function(t){var e=null;return _.each(this.types,function(n){try{n.name==t&&(e=n)}catch(a){console.log("XF.DeviceClass :: getTypeByName - bad type name - skipping"),console.log("XF.DeviceClass :: getTypeByName - @dev: plz verify types list")}}),e},detectTouchable:function(){var e=" -webkit- -moz- -o- -ms- ".split(" "),n=["@media (",e.join("touch-enabled),("),"app_device_test",")","{#touch{top:9px;position:absolute}}"].join(""),a=this;this.injectElementWithStyles(n,function(e){var n=document.styleSheets[document.styleSheets.length-1],i=(n?n.cssRules&&n.cssRules[0]?n.cssRules[0].cssText:n.cssText||"":"",e.childNodes),o=i[0];a.isTouchable="ontouchstart"in t||t.DocumentTouch&&document instanceof DocumentTouch||9===(o&&o.offsetTop)},1,["touch"]),console.log("XF.Device :: detectTouchable - device IS "+(this.isTouchable?"":"NOT ")+"touchable")},hasAnimation:function(){var t="Webkit Moz O ms Khtml".split(" "),e=document.createElement("div");if(e.style.animationName)return{prefix:""};for(var n=0;t.length>n;n++)if(void 0!==e.style[t[n]+"AnimationName"])return{prefix:"-"+t[n].toLowerCase()+"-"};return!1}(),injectElementWithStyles:function(t,e,n,a){var i,o,s,r=document.createElement("div"),l=document.body,c=l?l:document.createElement("body");if(parseInt(n,10))for(;n--;)s=document.createElement("div"),s.id=a?a[n]:"app_device_test"+(n+1),r.appendChild(s);return i=["&#173;","<style>",t,"</style>"].join(""),r.id="app_device_test",c.innerHTML+=i,c.appendChild(r),l||(c.style.background="",docElement.appendChild(c)),o=e(r,t),l?r.parentNode.removeChild(r):c.parentNode.removeChild(c),!!o},ORIENTATION_PORTRAIT:"portrait",ORIENTATION_LANDSCAPE:"landscape",getOrientation:function(){var t=!0,e=document.documentElement;return void 0!==$.support||(t=e&&1.1>e.clientWidth/e.clientHeight),t?this.ORIENTATION_PORTRAIT:this.ORIENTATION_LANDSCAPE},getScreenHeight:function(){var e=this.getOrientation(),n=e===this.ORIENTATION_PORTRAIT,a=n?480:320,i=n?screen.availHeight:screen.availWidth,o=Math.max(a,$(t).height()),s=Math.min(i,o);return s},getViewport:function(){var t=$("body").addClass("xf-viewport");return t[0]||(t=$(".xf-page").eq(0),t=t.length?t.parent():$("body"),t.addClass("xf-viewport")),t.eq(0)}},XF.trace=function(t){$("#tracer").html(t+"<br/>"+$("#tracer").html())},t.XF=XF}).call(this,window,Backbone),function(t){"use strict";function e(t){return"tagName"in t?t:t.parentNode}function n(t,e,n,a){var i=Math.abs(t-e),o=Math.abs(n-a);return i>=o?t-e>0?"Left":"Right":n-a>0?"Up":"Down"}function a(){i={}}var i={},o={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseup",istouch:!1},s=30,r=window.navigator.msPointerEnabled,l=!r&&(window.propertyIsEnumerable("ontouchstart")||window.document.hasOwnProperty("ontouchstart"));r?(o.touchstart="MSPointerDown",o.touchmove="MSPointerMove",o.touchend="MSPointerUp",o.touchcancel="MSPointerCancel",o.istouch=!1):l&&(o.touchstart="touchstart",o.touchmove="touchmove",o.touchend="touchend",o.touchcancel="touchcancel",o.istouch=!0),t(document).ready(function(){var r,l;t(document.body).bind(o.touchstart,function(n){r=Date.now(),l=r-(i.last||r),i.el=t(e(n.target)),i.x1=o.istouch?n.originalEvent.targetTouches[0].pageX:n.pageX,i.y1=o.istouch?n.originalEvent.targetTouches[0].pageY:n.pageY,i.last=r}).bind(o.touchmove,function(t){i.x2=o.istouch?t.originalEvent.targetTouches[0].pageX:t.pageX,i.y2=o.istouch?t.originalEvent.targetTouches[0].pageY:t.pageY,Math.abs(i.x1-i.x2)>10&&t.preventDefault()}).bind(o.touchend,function(){i.x2&&Math.abs(i.x1-i.x2)>s||i.y2&&Math.abs(i.y1-i.y2)>s?(i.direction=n(i.x1,i.x2,i.y1,i.y2),i.el.trigger("swipe"),i.el.trigger("swipe"+i.direction),i={}):"last"in i&&(i.el.trigger("tap"),i.el.unbind("click"))}).bind(o.touchcancel,a),t(window).bind("scroll",a)}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","tap"].forEach(function(e){t.fn[e]=function(t){return this.bind(e,t)}})}(jQuery),function(){$.fn.outerHtml=function(t){if(t)return this.each(function(){$(this).replaceWith(t)});var e=$("<div></div>").append($(this).clone()),n=e.html();return e.remove(),n}}.call(this,window,Backbone),function(){XF.UIElements={},_.extend(XF.UIElements,{enhanceView:function(t){!t instanceof $&&(t=$(t),!t instanceof $)||_.each(XF.UIElements.enhancementList,function(e){t.find(e.selector).not("[data-skip-enhance=true]").each(function(){var t=!1;_.each(XF.UIElements.enhanced.length,function(){XF.UIElements.enhanced[i]===this&&(t=!0)}),!t&"true"!=$(this).attr("data-skip-enhance")&&(XF.UIElements.enhanced.push(this),XF.UIElements[e.enhanceMethod](this))})})},enhancementList:{},enhanced:[]})}.call(this,window,Backbone),function(){XF.UIElements.enhancementList.button={selector:"A[data-role=button], BUTTON, INPUT[type=submit], INPUT[type=reset], INPUT[type=button] [data-appearance=backbtn]",enhanceMethod:"enhanceButton"},XF.UIElements.enhanceButton=function(t){var e=$(t);if(t&&!(!e instanceof $)&&"true"!=e.attr("data-skip-enhance")){var n,a;if("A"==t.nodeName||"BUTTON"==t.nodeName)n=e.attr({"data-skip-enhance":!0}),a=e.html(),e.html("");else{if("INPUT"!=t.nodeName)return;n=$("<div></div>").append(e.clone().addClass("xf-input-hidden").attr({"data-skip-enhance":!0})),e.outerHtml(n),a=e.attr("value")}var i="true"==e.attr("data-small")||"backbtn"==e.attr("data-appearance");n.addClass(i?"xf-button-small":"xf-button"),"backbtn"==e.attr("data-appearance")&&n.addClass("xf-button-back");var o=e.attr("data-icon");if("backbtn"==e.attr("data-appearance")&&(o="left"),o){var s=$("<span class=xf-icon></span>");s.addClass("xf-icon-"+o),i?s.addClass("xf-icon-small"):s.addClass("xf-icon-big");var r=e.attr("data-iconpos")||"left";"left"!=r&&"right"!=r&&"top"!=r&&"bottom"!=r&&(r="left"),n.addClass("xf-iconpos-"+r),n.append(s)}if(a){var l=$("<span></span>").append(a);i||"backbtn"==e.attr("data-appearance")?l.addClass("xf-button-small-text"):l.addClass("xf-button-text"),n.append(l)}"true"==e.attr("data-special")&&n.addClass("xf-button-special"),"true"==e.attr("data-alert")&&n.addClass("xf-button-alert"),"true"==e.attr("data-alert")&&n.addClass("xf-button-alert")}},XF.UIElements.createButton=function(t){var e=$("<button></button>");e.html(t.text);var n={};return t.icon&&""!=t.icon&&(n["data-icon"]=t.icon),t.iconpos&&""!=t.iconpos&&(n["data-iconpos"]=t.iconpos),t.small&&""!=t.small&&(n["data-small"]=t.small),t.appearance&&""!=t.appearance&&(n["data-appearance"]=t.appearance),t.special&&""!=t.special&&(n["data-special"]=t.special),t.alert&&""!=t.alert&&(n["data-alert"]=t.alert),_.isFunction(t.handler)&&e.click(t.handler),e.attr(n),XF.UIElements.enhanceButton(e[0]),e}}.call(this,window,Backbone),function(){XF.UIElements.enhancementList.checkboxRadio={selector:"INPUT[type=checkbox], INPUT[type=radio]",enhanceMethod:"enhanceCheckboxRadio"},XF.UIElements.enhanceCheckboxRadio=function(t){var e=$(t);if(t&&!(!e instanceof $)&&"true"!=e.attr("data-skip-enhance")){e.attr({"data-skip-enhance":!0});var n=e.attr("id"),a=$("label[for="+n+"]");if(a.length){var i=e.attr("type").toLowerCase(),o="switch"==e.attr("data-role"),s=$("<div></div>");o?(s.addClass("xf-switch"),s.append($('<label class="xf-switch-control"></label>').attr({"for":n}).append(e.clone()).append($("<span class=xf-switch-track><span class=xf-switch-track-wrap><span class=xf-switch-thumb></span></span></span>"))),s.append(a.addClass("xf-switch-label"))):(s.addClass("xf-input-"+i),s.append($('<label class="xf-input-positioner"></label>').attr({"for":n}).append(e.clone())),s.append(a.addClass("xf-input-label"))),e.outerHtml(s)}}}}.call(this,window,Backbone),function(){XF.UIElements.enhancementList.fieldset={selector:"fieldset[data-role=controlgroup]",enhanceMethod:"enhanceFieldset"},XF.UIElements.enhanceFieldset=function(t){var e=$(t);if(t&&!(!e instanceof $)&&"true"!=e.attr("data-skip-enhance")){e.attr({"data-skip-enhance":!0}),e.addClass("xf-controlgroup");var n=e.children("legend").detach();if(e.wrapInner("<div class=xf-controlgroup-controls>"),e.prepend(n),n.length){var a=$("<div></div>"),i={};_.each(n[0].attributes,function(t){i[t.name]=t.value}),a.attr(i),a.addClass("xf-label"),a.html(n.html()),n.outerHtml(a.outerHtml())}}}}.call(this,window,Backbone),function(){XF.UIElements.enhancementList.list={selector:"UL[data-role=listview], OL[data-role=listview]",enhanceMethod:"enhanceList"},XF.UIElements.enhanceList=function(t){var e=$(t);if(t&&!(!e instanceof $)&&"true"!=e.attr("data-skip-enhance")){e.attr({"data-skip-enhance":!0}),e.addClass("xf-listview"),"true"==e.attr("data-fullwidth")&&e.addClass("xf-listview-fullwidth"),e.children("li").addClass("xf-li"),e.children("li[data-role=divider]").addClass("xf-li-divider");var n=e.children("li"),a=n.children("a");a.addClass("xf-li-btn"),n.not(a.parent()).not("[data-role=divider]").addClass("xf-li-static"),e.children("li[data-icon]").children("a").each(function(){var t=$(this),e=t.parent().attr("data-icon");t.append($("<span></span>").addClass("xf-icon xf-icon-big xf-icon-"+e));var n=t.parent().attr("data-iconpos");"left"!=n&&"right"!=n&&(n="right"),t.addClass("xf-li-with-icon-"+n)}),a.children(".xf-count-bubble").parent().addClass("xf-li-has-count"),a.children("img").parent().each(function(){var t=$(this),e=t.parent().attr("data-thumbpos");"right"!=e&&"left"!=e&&(e="left"),t.addClass("xf-li-with-thumb-"+e),t.children("img").addClass("xf-li-thumb xf-li-thumb-"+e)}),a.each(function(){var t=$(this);t.append($("<div class=xf-btn-text></div>").append(t.children().not(".xf-icon, .xf-count-bubble, .xf-li-thumb")))}),n.find("h1, h2, h3, h4, h5, h6").addClass("xf-li-header"),n.find("p").addClass("xf-li-desc"),n.filter(".xf-li-static").each(function(){$(this).wrapInner("<div class=xf-li-wrap />")})}}}.call(this,window,Backbone),function(){XF.UIElements.createPopup=function(){var t=$('<div class="xf-dialog "><div class="xf-dialog-content"></div></div>');return t},XF.UIElements.showDialog=function(t,e,n){var a=XF.UIElements.createDialog(t,e,n);XF.UIElements.showPopup(a)},XF.UIElements.showPopup=function(t){XF.Device.getViewport().append(t)},XF.UIElements.hidePopup=function(t){t.detach()},XF.UIElements.createDialog=function(t,e,n){var a=XF.UIElements.createPopup();a.find(".xf-dialog-content").append($("<div></div>").addClass("xf-dialog-box").append($("<div></div>").addClass("xf-dialog-box-header").append($("<h3></h3>").html(t))).append($("<div></div>").addClass("xf-dialog-box-content").html(e)).append($("<div></div>").addClass("xf-dialog-box-footer clearfix")));var i=a.find(".xf-dialog-box-footer");if(n||(n=[{text:"OK",handler:function(){XF.UIElements.hidePopup(a)}}]),n){var o,s=n.length;_.each(n,function(t){o=t instanceof $?t:XF.UIElements.createButton(t),i.append($("<div></div>").addClass("xf-grid-unit xf-grid-unit-1of"+s).append(o))})}return XF.UIElements.dialog=a,a},XF.UIElements.createNotification=function(t,e){var n=XF.UIElements.createPopup().addClass("xf-dialog-notification");return n.find(".xf-dialog-content").append($("<div></div>").addClass("xf-notification").append($("<div></div>").addClass("xf-notification-wrap").append($("<div></div>").addClass("xf-notification-text").html(t)))),e&&""!=e&&n.find(".xf-notification-wrap").prepend($("<div></div>").addClass("xf-notification-icon").append($("<span></span>").addClass("xf-icon xf-icon-xl xf-icon-"+e))),n},XF.UIElements.loadingNotification=null,XF.UIElements.dialog=null,XF.UIElements.setLoadingNotification=function(t){XF.UIElements.loadingNotification=t},XF.UIElements.showLoading=function(t,e){(t||e)&&(XF.UIElements.loadingNotification&&XF.UIElements.hideLoading(),XF.UIElements.setLoadingNotification(XF.UIElements.createNotification(t,e))),XF.UIElements.loadingNotification||XF.UIElements.setLoadingNotification(XF.UIElements.createNotification("Loading...")),XF.UIElements.showPopup(XF.UIElements.loadingNotification)},XF.UIElements.hideLoading=function(){XF.UIElements.loadingNotification&&XF.UIElements.hidePopup(XF.UIElements.loadingNotification)},XF.UIElements.hideDialog=function(){XF.UIElements.dialog&&XF.UIElements.hidePopup(XF.UIElements.dialog)
}}.call(this,window,Backbone),function(){XF.UIElements.enhancementList.scrollable={selector:"[data-scrollable=true]",enhanceMethod:"enhanceScrollable"},XF.UIElements.enhanceScrollable=function(t){var e=$(t);if(t&&!(!e instanceof $)&&"true"!=e.attr("data-skip-enhance")){e.attr({"data-skip-enhance":!0});var n=e.children();e.append($("<div></div>").addClass("xf-scrollable-content").append(n));var a=e.attr("id");a&&""!=a||(a="xf_scrollable_"+(new Date).getTime(),e.attr({id:a}));var i=e.data("iscroll",new iScroll(a)),o=!1,s=function(){o&&(o=!1,i.data("iscroll").refresh(),l())},r=function(){$.contains($("#"+a)[0],this)&&(o=!0,setTimeout(s,100))},l=function(){$("#"+a+" *").bind("detach",r).bind("hide",r).bind("show",r).bind("append",r).bind("prepend",r).bind("html",r).bind("resize",r)};l()}}}.call(this,window,Backbone),function(){XF.UIElements.enhancementList.textinput={selector:"INPUT[type=text], INPUT[type=search], INPUT[type=tel], INPUT[type=url], INPUT[type=email], INPUT[type=password], INPUT[type=datetime], INPUT[type=date], INPUT[type=month], INPUT[type=week], INPUT[type=time], INPUT[type=datetime-local], INPUT[type=number], INPUT[type=color], TEXTAREA, INPUT[type=range], INPUT[type=search]",enhanceMethod:"enhanceTextInput"},XF.UIElements.enhanceTextInput=function(t){var e=$(t);if(t&&!(!e instanceof $)&&"true"!=e.attr("data-skip-enhance")){e.attr({"data-skip-enhance":!0}),e.addClass("xf-input-text");var n="INPUT"==t.nodeName,a=e.attr("type");if("search"==a){var i=$('<input type="text"/>'),o={};_.each(t.attributes,function(t){"type"!=t.name&&(o[t.name]=t.value)}),i.attr(o),e.outerHtml(i),e=i,t=i[0]}else if("number"==a||"range"==a){var s=e.attr("min"),r=e.attr("max"),l=parseFloat(e.attr("value")),c=parseFloat(e.attr("step"))||1,i=$('<input type="text"/>'),o={};_.each(t.attributes,function(t){"type"!=t.name&&(o[t.name]=t.value)}),i.attr(o),i.attr({"data-skip-enhance":!0});var d=$("<div></div>").addClass("xf-input-number");d.append($('<button type="button"></button>').addClass("xf-input-number-control xf-input-number-control-decrease").attr({"data-skip-enhance":!0}).append($("<span></span>").addClass("xf-icon xf-icon-big xf-icon-minus-circled"))),d.append(i),d.append($('<button type="button"></button>').addClass("xf-input-number-control xf-input-number-control-increase").attr({"data-skip-enhance":!0}).append($("<span></span>").addClass("xf-icon xf-icon-big xf-icon-plus-circled")));var p=null;if("number"==a)e.outerHtml(d),e=d,t=d[0];else if("range"==a&&(p=$("<div></div>").addClass("xf-range"),p.append(d),(s||0===s)&&(r||0===r))){s=parseFloat(s),r=parseFloat(r);var h=100*(l-s)/(r-s);p.append($("<div></div>").addClass("xf-input-range").append($("<div></div>").addClass("xf-range-wrap").append($("<div></div>").addClass("xf-input-range-min").html(s)).append($("<div></div>").addClass("xf-input-range-slider").append($("<div></div>").addClass("xf-input-range-track").append($("<div></div>").addClass("xf-input-range-value").css({width:""+h+"%"}).append($("<div></div>").addClass("xf-input-range-control").attr({tabindex:"0"}).append($("<div></div>").addClass("xf-input-range-thumb").attr({title:""+l}).css({left:"100%"})))))).append($("<div></div>").addClass("xf-input-range-max").html(r)))).append($("<div></div>").addClass("xf-slider")),e.outerHtml(p),e=p,t=p[0]}var u=function(t){var e=t%c,n=t-e;if(e>c/2&&(n+=c),t=n,(r||0===r)&&t>r&&(t=r),(s||0===s)&&s>t&&(t=s),l=t,i.attr({value:t}),p){p.find("div.xf-input-range-thumb").attr({title:t});var a=100*(t-s)/(r-s);p.find("div.xf-input-range-value").css({width:""+a+"%"})}},f=function(){var t=parseFloat(i.attr("value"));t+=c,u(t)},m=function(){var t=parseFloat(i.attr("value"));t-=c,u(t)};d.find("button.xf-input-number-control-decrease").click(m),d.find("button.xf-input-number-control-increase").click(f);var g,v=i.attr("value"),b=function(){g=i.attr("value"),v!=g&&(g=parseFloat(g),isNaN(g)&&(g=s),v=g,u(g))};if(i.change(b).focus(b).focusout(b),p){var F,x,X,w,y,C=void 0,T=function(t){return C||(C=p.find("div.xf-input-range-track")[0].clientWidth),t/C*(r-s)},U=function(t){return T(t)+s},k=function(){X=event.pageX||event.clientX||layerX||event.screenX,F=l,$(document).bind("mouseup",P),$(document).bind("mousemove",I)},I=function(){w=event.pageX||event.clientX||layerX||event.screenX,y=w-X,x=T(y),X=w,F+=x,u(F)},P=function(){$(document).unbind("mouseup",P),$(document).unbind("mousemove",I)},L=function(){$(document).bind("keydown",E)},E=function(t){switch(t.keyCode){case 33:u(l+3*c);break;case 34:u(l-3*c);break;case 35:u(r);break;case 36:u(s);break;case 38:case 39:u(l+c);break;case 37:case 40:u(l-c)}},N=function(){$(document).unbind("keydown",E)};p.find("div.xf-input-range-thumb").bind("mousedown",k),p.find("div.xf-input-range-control").bind("focus",L).bind("focusout",N);var D=function(t){t.target!=p.find("div.xf-input-range-thumb")[0]&&u(U(t.offsetX))};p.find("div.xf-input-range-track").bind("click",D)}}var R=!1;if("split"==e.attr("data-appearance")&&n){var S=["text","search","tel","url","email","password","datetime","date","month","week","time","datetime-local","color"];_.each(S,function(t){a==t&&(R=!0)})}var B=e.attr("id"),O=B.length?$("label[for="+B+"]"):[];if(O.length)if(R){e.removeClass("xf-input-text").addClass("xf-input-split-input"),O.addClass("xf-input-split-label");var M=$("<div></div>").addClass("xf-input-split");M.append($("<div></div>").addClass("xf-grid-unit xf-input-split-part1").append(O)),M.append($("<div></div>").addClass("xf-grid-unit xf-input-split-part2").append(e.clone())),e.outerHtml(M),e=M,t=M[0]}else O.addClass("xf-label")}}}.call(this,window,Backbone);